<!DOCTYPE html>
<html>
<head>
  <title>R-Love-App</title>
  <!-- VENDOR STYLESHEET -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.6/css/materialize.min.css">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <!-- LOCAL LINKS -->
  <%= csrf_meta_tags %>
</head>
<body>
  <nav class="z-depth-0">
    <div class="nav-wrapper z-depth-0">
      <a href="#!" class="brand-logo">rLove</a>
      <a href="#" data-activates="mobile-demo" class="button-collapse"><i class="material-icons">menu</i></a>
      <ul class="right hide-on-med-and-down">
        <% if current_user %>
          <li><a href="/users/<%= current_user.id %>">Profile</a></li>
          <li><a href="/users/<%= current_user.id %>/edit">Edit</a></li>
          <li><a href="/restaurants">Restaurants</a></li>
          <li><%= link_to "Log Out", logout_path, method: "delete" %> </li>
        <% else %>
          <li><a href="/users/new">Sign up</a></li>
          <li><%= link_to "Login", login_path %></li>
        <% end %>
      </ul>
      <ul class="side-nav" id="mobile-demo">
        <% if current_user %>
          <li><a href="/users/<%= current_user.id %>">Profile</a></li>
          <li><a href="/users/<%= current_user.id %>/edit">Edit</a></li>
          <li><a href="/restaurants">Restaurants</a></li>
          <li><%= link_to "Log Out", logout_path, method: "delete" %> </li>
        <% else %>
          <li><a href="/users/new">Sign up</a></li>
          <li><%= link_to "Login", login_path %></li>
        <% end %>
      </ul>
    </div>
  </nav>

  <div class="flash-message">
    <% flash.each do |key, value| %>
      <div class="alert alert-<%= key %>"><%= value %></div>
    <% end %>
  </div>

<%= yield %>

<script>
$(document).ready(function(){
$.getJSON('http://ipinfo.io', function(data){
  var location = data.loc;
  return googleLocation(location);
  })
  function googleLocation(loc){
    console.log(loc);
    $.ajax({
      url: "https://maps.googleapis.com/maps/api/place/nearbysearch/json?location=" + loc + "&radius=8046&sensor=true&rankby=prominence&opennow=true&key=AIzaSyDgS3jO-2X_dYen4FgwTjhm8L2dSgpkWrc&types=restaurant"
    })
  }
})
</script>
<%= stylesheet_link_tag    'application', media: 'all', 'data-turbolinks-track' => true %>
<%= javascript_include_tag 'application', 'data-turbolinks-track' => true %>


<!-- VENDOR JAVASCRIPTS -->
<script src = "https://code.jquery.com/jquery-3.0.0.min.js"></script>
<script src= "https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.6/js/materialize.min.js"></script>

</body>
</html>
